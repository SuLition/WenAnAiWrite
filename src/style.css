@layer base {
    :root {
        /* 启用 height: auto 动画支持 (Chrome 129+) */
        interpolate-size: allow-keywords;
        
        --primary-color: rgb(0, 161, 214);
        --primary-text: rgb(233, 233, 233);
        --scroller-color: color-mix(
                in srgb,
                var(--primary-color) 60%,
                var(--block-color)
        );
        --content-color: #1a1a1a;
        --desc-color: #9e9e9e;
        --split-color: #e0e0e0;
        --block-color: #fafafa;
        --solid-block-color: #fafafa;
        --button-color: #00000009;
        --solid-button-color: #00000006;
    }

    .dark {
        --content-color: rgb(233, 233, 233);
        --desc-color: #a2a7ae;
        --split-color: #c4c4c433;
        --block-color: #ffffff0d;
        --solid-block-color: #24292e;
        --button-color: #a2a7ae18;
        --solid-button-color: #a2a7ae10;
    }

    html.light :is(button, input) {
        @apply hover:brightness-[.98];
    }

    html.dark :is(button, input) {
        @apply hover:brightness-150;
    }

    body {
        @apply overflow-hidden h-screen w-screen;
    }

    * {
        font-family: system-ui,
        -apple-system,
        BlinkMacSystemFont,
        'Segoe UI',
        Roboto,
        Oxygen,
        Ubuntu,
        Cantarell,
        'Open Sans',
        'Helvetica Neue',
        sans-serif;
        text-rendering: optimizeLegibility;
        @apply select-none box-border;
    }

    #app {
        @apply flex w-full h-full text-(--content-color);
    }

    #main {
        @apply flex flex-col relative w-full h-full overflow-hidden;

        &::before {
            @apply content-[''] absolute inset-0 bg-black/60 z-1;
            @apply transition-opacity opacity-0 pointer-events-none;
        }

        &:has(.popup)::before {
            @apply opacity-100 pointer-events-auto;
        }
    }

    h1 {
        @apply text-2xl font-semibold;
    }

    button,
    input[type='text'],
    input[type='password'],
    input[type='number'] {
        @apply appearance-none outline-none leading-none h-8 rounded-lg text-sm px-2.5 py-1.5;
        @apply bg-(--button-color) transition-[filter];
    }

    button {
        @apply cursor-pointer;
    }

    a {
        @apply cursor-pointer text-(--primary-color);
    }

    hr {
        @apply border-none h-px my-4 bg-(--split-color) shrink-0;
    }

    img {
        -webkit-user-drag: none;
    }

    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: var(--scrollbar-thumb, #3d3f43);
        border-radius: 4px;
        border: 2px solid transparent;
        background-clip: padding-box;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: var(--scrollbar-hover, #4a9eff);
        border: 2px solid transparent;
        background-clip: padding-box;
    }

    ::-webkit-scrollbar-corner {
        background: transparent;
    }

    ::selection {
        @apply bg-(--scroller-color);
    }

    i + span,
    span + i {
        @apply ml-2;
    }
}

@layer components {
    .page {
        @apply flex flex-col relative justify-center items-center w-full h-full;
        @apply px-6 overflow-hidden transition-opacity opacity-100;

        &.hide {
            @apply opacity-0;
        }
    }

    .desc {
        @apply text-sm text-(--desc-color) inline-block whitespace-pre-wrap shrink-0;
    }

    .text,
    .text * {
        user-select: text;
    }

    .primary-color {
        color: var(--primary-text);
        background-color: var(--primary-color);
    }

    .checkbox {
        @apply relative flex h-4 w-4 mr-4 items-center justify-center;

        input[type='checkbox'] {
            @apply absolute appearance-none h-4 w-4 rounded-sm outline-0;
            @apply border border-(--split-color);
            @apply bg-(--solid-button-color);
            @apply transition-colors;
        }

        i {
            @apply invisible z-10 pointer-events-none text-xs;
            @apply text-(--primary-text);
        }

        input[type='checkbox']:checked {
            @apply bg-(--primary-color);

            & + i {
                @apply visible;
            }
        }
    }

    .tab {
        @apply flex flex-col items-start gap-1;

        button {
            @apply pr-0 w-48 flex items-center justify-end gap-2 bg-transparent;
            @apply border-none hover:bg-(--solid-button-color);

            i {
                @apply w-4;
            }

            label {
                @apply w-0.75 rounded-md h-4 invisible shrink-0;
            }

            &.active {
                @apply bg-(--button-color) text-(--primary-color);

                label {
                    @apply visible;
                }
            }
        }
    }

    i.question {
        @apply hover:cursor-pointer hover:brightness-85 text-(--desc-color);
    }

    .popup {
        @apply flex flex-col rounded-lg shadow-lg bg-(--solid-block-color);
        @apply absolute inset-0 m-auto w-fit! h-fit! gap-2 p-4 z-2;

        .close {
            @apply absolute top-4 right-4 rounded-full w-8 h-8;
        }
    }

    .markdown {
        p {
            @apply text-(--desc-color) italic;
        }

        h3 {
            @apply mb-2 mt-4 font-bold text-lg;
        }

        li {
            @apply list-disc list-inside ml-4;
        }
    }
}

.dp__main {
    @apply w-40!;

    &.dp__theme_dark {
        --dp-border-color: var(--block-color) !important;
    }

    .dp__input {
        @apply text-sm! bg-(--block-color)! rounded-lg! h-8!;
    }

    .dp__menu {
        @apply text-sm!;
    }

    .dp--tp-wrap {
        @apply hidden;
    }
}

/* 公共加载按钮样式 */
.btn-loading {
    position: relative;
    pointer-events: none;
    color: transparent !important;
}

.btn-loading::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: radial-gradient(farthest-side, var(--accent-color, #4a9eff) 94%, #0000) top/3px 3px no-repeat,
    conic-gradient(#0000 30%, var(--accent-color, #4a9eff));
    -webkit-mask: radial-gradient(farthest-side, #0000 calc(100% - 3px), #000 0);
    mask: radial-gradient(farthest-side, #0000 calc(100% - 3px), #000 0);
    animation: btn-spin 0.8s linear infinite;
}

@keyframes btn-spin {
    to {
        transform: translate(-50%, -50%) rotate(1turn);
    }
}

/* 公共进度按钮样式 - 使用方式: class="btn-progress" :style="{ '--progress': progress + '%' }" */
.btn-progress {
    position: relative;
    overflow: hidden;
    background: var(--bg-tertiary, #3d3f43) !important;
    cursor: not-allowed !important;
    pointer-events: none;
}

.btn-progress > * {
    position: relative;
    z-index: 2;
}

.btn-progress::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    width: var(--progress, 0%);
    background: linear-gradient(90deg, var(--accent-color, #4a9eff) 0%, var(--accent-hover, #3d8fe8) 100%);
    transition: width 0.3s ease-out;
    z-index: 1;
}

/* vue-sonner Toast action 按钮样式 */
[data-sonner-toaster] [data-button] {
    background: transparent !important;
    border: 1px solid var(--accent-color, #4a9eff) !important;
    color: var(--accent-color, #4a9eff) !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    padding: 6px 12px !important;
    border-radius: 6px !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
}

[data-sonner-toaster] [data-button]:hover {
    background: var(--accent-color, #4a9eff) !important;
    color: #fff !important;
}

/* ========== 通用过渡动画 (Transition / TransitionGroup) ========== */
/* 淡入淡出 */
.fade-enter-active,
.fade-leave-active {
    transition: all var(--transition-normal, 300ms) var(--easing-ease, ease);
}

.fade-enter-from,
.fade-leave-to {
    opacity: 0;
}

.fade-move {
    transition: transform var(--transition-normal, 300ms) var(--easing-ease, ease);
}

/* 左滑 */
.slide-left-enter-active,
.slide-left-leave-active {
    transition: all var(--transition-normal, 300ms) var(--easing-ease-out, ease-out);
}

.slide-left-enter-from {
    opacity: 0;
    transform: translateX(30px);
}

.slide-left-leave-to {
    opacity: 0;
    transform: translateX(-30px);
}

.slide-left-move {
    transition: transform var(--transition-normal, 300ms) var(--easing-ease, ease);
}

/* 右滑 */
.slide-right-enter-active,
.slide-right-leave-active {
    transition: all var(--transition-normal, 300ms) var(--easing-ease-out, ease-out);
}

.slide-right-enter-from {
    opacity: 0;
    transform: translateX(-30px);
}

.slide-right-leave-to {
    opacity: 0;
    transform: translateX(30px);
}

.slide-right-move {
    transition: transform var(--transition-normal, 300ms) var(--easing-ease, ease);
}

/* 上滑 */
.slide-up-enter-active,
.slide-up-leave-active {
    transition: all var(--transition-normal, 300ms) var(--easing-ease-out, ease-out);
}

.slide-up-enter-from {
    opacity: 0;
    transform: translateY(30px);
}

.slide-up-leave-to {
    opacity: 0;
    transform: translateY(-30px);
}

.slide-up-move {
    transition: transform var(--transition-normal, 300ms) var(--easing-ease, ease);
}

/* 缩放 */
.zoom-enter-active,
.zoom-leave-active {
    transition: all var(--transition-normal, 300ms) var(--easing-ease, ease);
}

.zoom-enter-from {
    opacity: 0;
    transform: scale(0.9);
}

.zoom-leave-to {
    opacity: 0;
    transform: scale(0.9);
}

.zoom-move {
    transition: transform var(--transition-normal, 300ms) var(--easing-ease, ease);
}

/* 无效果 */
.none-enter-active,
.none-leave-active {
    transition: none;
}